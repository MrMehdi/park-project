/******************************************************************************************
** 头文件
*******************************************************************************************/
#include "basic_adc.h"

/********************************************************************************************
** 定义变量
********************************************************************************************/

	
/********************************************************************************************
** 函数申明
********************************************************************************************/
/********************************************************************************************
** 内容
********************************************************************************************/

/********************************************************************************************
** 函数名称：	
** 函数作用：获取某个通道ADC值
** 参数：   channel 通道号
** 返回值:该通道的电压值,该电压值为实际电压值的 1000倍

********************************************************************************************/
uint32_t basic_adc_get_volt(uint8_t adc_channel)
{
    rt_adc_device_t  adc_dev = 0;
	uint32_t  get_value = 0, voltage = 0;
	
    //.......................................查找设备......................................
	adc_dev = (rt_adc_device_t)rt_device_find(ADC_DEV_NAME);
	if(adc_dev == RT_NULL)
     {
		rt_kprintf(" can't find %s device!\n",  ADC_DEV_NAME);
        return RT_ERROR;
	}

   //....................................... 使能设备......................................
    rt_adc_enable(adc_dev, adc_channel);

   //....................................... 读取采样值......................................
    get_value = rt_adc_read(adc_dev, adc_channel);
    voltage =   get_value * ADC_VREF / 4096;  //1000倍
  
    //.......................................关闭通道......................................
    rt_adc_disable(adc_dev, adc_channel);

	return voltage;
}

